<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>graspologic.plot.plot_matrix &mdash; graspologic 2.0.1dev3252523757 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> graspologic
          </a>
              <div class="version">
                2.0.1dev3252523757
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/install.html">Install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/install.html#install-the-released-version">Install the released version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/install.html#python-package-dependencies">Python package dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/install.html#hardware-requirements">Hardware requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/install.html#os-requirements">OS Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/install.html#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/contributing.html">Contributing to graspologic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/in-the-wild.html">graspologic in the wild</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/in-the-wild.html#papers">Papers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/in-the-wild.html#educational-materials">Educational materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/in-the-wild.html#blog-posts">Blog posts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/release.html">Release Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/release.html#graspologic-2-0-0">graspologic 2.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/release.html#graspologic-1-0-0">graspologic 1.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/release.html#graspologic-0-3-0">graspologic 0.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/release.html#graspologic-0-2-0">graspologic 0.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/release.html#graspologic-0-1-0">graspologic 0.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/release.html#previous-graspy-releases">Previous GraSPy Releases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/release/graspy_releases.html">GraSPy Release Log</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/align.html">Aligning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/align.html#sign-flips">Sign flips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/align.html#orthogonal-procrustes">Orthogonal Procrustes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/align.html#seedless-procrustes">Seedless Procrustes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/cluster.html">Clustering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/cluster.html#k-means-clustering">K-Means Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/cluster.html#gaussian-mixture-models-clustering">Gaussian Mixture Models Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/cluster.html#hierarchical-clustering">Hierarchical Clustering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/datasets.html">Datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/datasets.html#drosophila-larval-mushroom-body">Drosophila larval mushroom body</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/datasets.html#duke-mouse-whole-brain-connectomes">Duke mouse whole-brain connectomes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/embed.html">Embedding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/embed.html#decomposition">Decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/embed.html#single-graph-embedding">Single graph embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/embed.html#multiple-graph-embedding">Multiple graph embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/embed.html#dissimilarity-graph-embedding">Dissimilarity graph embedding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/inference.html">Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/inference.html#two-graph-hypothesis-testing">Two-graph hypothesis testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/layouts.html">Layouts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/layouts.html#nodeposition">NodePosition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/layouts.html#automatic-graph-layout">Automatic Graph Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/layouts.html#colors">Colors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/layouts.html#rendering">Rendering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/match.html">Matching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/match.html#graph-matching">Graph Matching</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/models.html">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/models.html#erdos-reyni-models">Erdos-Reyni models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/models.html#stochastic-block-models">Stochastic block models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/models.html#latent-position-models">Latent position models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/models.html#edge-swapping-configuration-models">Edge swapping (configuration models)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/nominate.html">Nomination</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/nominate.html#spectral-vertex-nomination">Spectral Vertex Nomination</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/nominate.html#vertex-nomination-via-sgm">Vertex Nomination via SGM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/partition.html">Partition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/partition.html#modularity-and-component-modularity">Modularity and Component Modularity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/partition.html#leiden-and-hierarchical-leiden">Leiden and Hierarchical Leiden</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/preconditions.html">Preconditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/preconditions.html#graspologic.preconditions.check_argument_types"><code class="docutils literal notranslate"><span class="pre">check_argument_types()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/preconditions.html#graspologic.preconditions.check_optional_argument_types"><code class="docutils literal notranslate"><span class="pre">check_optional_argument_types()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/preconditions.html#graspologic.preconditions.check_argument"><code class="docutils literal notranslate"><span class="pre">check_argument()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/preconditions.html#graspologic.preconditions.is_real_weighted"><code class="docutils literal notranslate"><span class="pre">is_real_weighted()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/pipeline.html">Pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/pipeline.html#graphbuilder">GraphBuilder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/pipeline.html#module-graspologic.pipeline.embed">Embed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/plotting.html">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/plotting.html#heatmap">Heatmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/plotting.html#gridplot">Gridplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/plotting.html#pairplot">Pairplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/plotting.html#degreeplot">Degreeplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/plotting.html#edgeplot">Edgeplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/plotting.html#screeplot">Screeplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/plotting.html#adjplot">Adjplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/plotting.html#matrixplot">Matrixplot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/preprocessing.html">Preprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/preprocessing.html#graph-cuts">Graph Cuts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/simulations.html">Simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/simulations.html#graspologic.simulations.er_np"><code class="docutils literal notranslate"><span class="pre">er_np()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/simulations.html#graspologic.simulations.er_nm"><code class="docutils literal notranslate"><span class="pre">er_nm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/simulations.html#graspologic.simulations.sbm"><code class="docutils literal notranslate"><span class="pre">sbm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/simulations.html#graspologic.simulations.rdpg"><code class="docutils literal notranslate"><span class="pre">rdpg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/simulations.html#graspologic.simulations.er_corr"><code class="docutils literal notranslate"><span class="pre">er_corr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/simulations.html#graspologic.simulations.sbm_corr"><code class="docutils literal notranslate"><span class="pre">sbm_corr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/simulations.html#graspologic.simulations.rdpg_corr"><code class="docutils literal notranslate"><span class="pre">rdpg_corr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/simulations.html#graspologic.simulations.mmsbm"><code class="docutils literal notranslate"><span class="pre">mmsbm()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/subgraph.html">Subgraph</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/subgraph.html#signal-subgraph-estimators">Signal-Subgraph Estimators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/reference/utils.html">Utility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/utils.html#transformations">Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/utils.html#connected-components">Connected Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/utils.html#io">IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/reference/utils.html#other">Other</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#models">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/models/models.html">Random Graph Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/models/edge_swaps.html">Degree Preserving Edge Swaps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#simulations">Simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/simulations/erdos_renyi.html">Erdos-Renyi (ER) Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/simulations/sbm.html">Stochastic Block Model (SBM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/simulations/mmsbm.html">Mixed Membership Stochastic Blockmodel (MMSBM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/simulations/rdpg.html">Random Dot Product Graph (RDPG) Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/simulations/corr.html">Correlated Graph Pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/simulations/rdpg_corr.html">Correlated Random Dot Product Graph (RDPG) Graph Pair</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#clustering">Clustering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/clustering/autogmm.html">Automatic Gaussian Mixture Modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/clustering/kclust.html">K-Means Clustering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#embedding">Embedding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/embedding/AdjacencySpectralEmbed.html">Adjacency Spectral Embed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/embedding/OutOfSampleEmbed.html">Out-of-Sample (OOS) Embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/embedding/CovariateAssistedEmbed.html">Covariate-Assisted Embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/embedding/MASE.html">Multiple Adjacency Spectral Embedding (MASE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/embedding/Omnibus.html">Omnibus Embedding for Multiple Graphs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#inference">Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/inference/latent_position_test.html">Latent Position Two-Graph Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/inference/latent_distribution_test.html">Latent Distribution Two-Graph Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#plotting">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/plotting/heatmaps.html">Heatmap: Visualizing a Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/plotting/gridplot.html">Gridplot: Visualize Multiple Graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/plotting/pairplot.html">Pairplot: Visualizing High Dimensional Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/plotting/matrixplot.html">Matrixplot and Adjplot: Visualize and sort matrices with metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/plotting/pairplot_with_gmm.html">Pairplot with GMM: Visualizing High Dimensional Data and Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/plotting/networkplot.html">Networkplot: Visualizing 2D Layouts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#matching">Matching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/matching/faq.html">Introduction to Graph Matching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/matching/sgm.html">Seeded Graph Matching (SGM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/matching/padded_gm.html">Padded Graph Matching</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#subgraph">Subgraph</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/subgraph/subgraph.html">Signal Subgraph Estimators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#vertex-nomination">Vertex Nomination</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/vertex_nomination/SpectralVertexNomination.html">Spectral Vertex Nomination</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/nominate/vertex_nomination_via_SGM.html">Nomination via SGM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#aligning">Aligning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/aligning/aligning.html">Aligning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#connectomics">Connectomics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/connectomics/mcc.html">Methods for Multiscale Comparative Connectomics</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Useful Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://www.github.com/microsoft/graspologic/">graspologic &#64; GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/graspologic/">graspologic &#64; PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/microsoft/graspologic/issues">Issue Tracker</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">graspologic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>graspologic.plot.plot_matrix</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for graspologic.plot.plot_matrix</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) Microsoft Corporation and contributors.</span>
<span class="c1"># Licensed under the MIT License.</span>

<span class="c1"># type: ignore</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">csr_matrix</span>


<span class="k">def</span> <span class="nf">_check_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;scattermap&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">csr_matrix</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`data` must be a np.ndarray or scipy.sparse.csr_matrix.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;heatmap&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;`data` must be a np.ndarray. If your data is a sparse matrix, please&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; make sure that `plot_type` is set to &#39;scattermap&#39;&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`data` must have dimension 2.&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_check_item_in_meta</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">iter</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> must be an iterable or string corresponding to columns in meta&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meta</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;group_order&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">col_name</span> <span class="o">==</span> <span class="s2">&quot;size&quot;</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col_name</span><span class="si">}</span><span class="s2"> is not a column in the meta dataframe.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">item</span>


<span class="k">def</span> <span class="nf">_check_length</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Length of </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> must be the same as corresponding data axis&quot;</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">_check_plotting_kws</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="n">palette</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;There is not enough palette value for each color class&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">palette</span>


<span class="k">def</span> <span class="nf">_check_sorting_kws</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">group_order</span><span class="p">,</span> <span class="n">item_order</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">highlight</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="c1"># if meta is here, than everything else must be column item in meta</span>
        <span class="n">_check_length</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="s2">&quot;meta&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">_check_item_in_meta</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">)</span>
        <span class="n">group_order</span> <span class="o">=</span> <span class="n">_check_item_in_meta</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">group_order</span><span class="p">,</span> <span class="s2">&quot;group_order&quot;</span><span class="p">)</span>
        <span class="n">item_order</span> <span class="o">=</span> <span class="n">_check_item_in_meta</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">item_order</span><span class="p">,</span> <span class="s2">&quot;item_order&quot;</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">_check_item_in_meta</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">)</span>
        <span class="n">highlight</span> <span class="o">=</span> <span class="n">_check_item_in_meta</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">highlight</span><span class="p">,</span> <span class="s2">&quot;highlight&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># otherwise, arguments can be a hodgepodge of stuff</span>
        <span class="n">group_meta</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span> <span class="n">_item_to_df</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">group_order_meta</span><span class="p">,</span> <span class="n">group_order</span> <span class="o">=</span> <span class="n">_item_to_df</span><span class="p">(</span><span class="n">group_order</span><span class="p">,</span> <span class="s2">&quot;group_order&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">item_order_meta</span><span class="p">,</span> <span class="n">item_order</span> <span class="o">=</span> <span class="n">_item_to_df</span><span class="p">(</span><span class="n">item_order</span><span class="p">,</span> <span class="s2">&quot;item_order&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">color_meta</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">_item_to_df</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">highlight_meta</span><span class="p">,</span> <span class="n">highlight</span> <span class="o">=</span> <span class="n">_item_to_df</span><span class="p">(</span><span class="n">highlight</span><span class="p">,</span> <span class="s2">&quot;highlight&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">metas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">group_meta</span><span class="p">,</span>
            <span class="n">group_order_meta</span><span class="p">,</span>
            <span class="n">item_order_meta</span><span class="p">,</span>
            <span class="n">color_meta</span><span class="p">,</span>
            <span class="n">highlight_meta</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">metas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">metas</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">metas</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">meta</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">group_order</span><span class="p">,</span> <span class="n">item_order</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">highlight</span>


<span class="k">def</span> <span class="nf">_get_separator_info</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">meta</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">sep</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="n">sep_inds</span> <span class="o">=</span> <span class="n">sep</span><span class="p">[</span><span class="s2">&quot;sort_idx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">sep_inds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sep</span><span class="p">[</span><span class="s2">&quot;sort_idx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">last</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span>
    <span class="n">sep_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last</span><span class="p">[</span><span class="s2">&quot;sort_idx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sep_inds</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_item_to_df</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;group_order&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="s2">&quot;size&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">_check_length</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">item_meta</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_0&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">length</span><span class="p">:</span>  <span class="c1"># assuming elements of list are metadata</span>
            <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">_check_length</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">item_meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">elem</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">item</span><span class="p">)})</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Numpy array passed as </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> must be 1 or 2d.&quot;</span><span class="p">)</span>
        <span class="n">_check_length</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">item_meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">item</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> must be a pd.Series, np.array, or list.&quot;</span><span class="p">)</span>

    <span class="n">item</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">item_meta</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">item_meta</span><span class="p">,</span> <span class="n">item</span>


<span class="k">def</span> <span class="nf">_set_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>


<span class="k">def</span> <span class="nf">_remove_shared_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove ax from its sharex and sharey</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Remove ax from the Grouper object</span>
    <span class="n">shax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_shared_x_axes</span><span class="p">()</span>
    <span class="n">shay</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_shared_y_axes</span><span class="p">()</span>
    <span class="n">shax</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">shay</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Set a new ticker with the respective new locator and formatter</span>
    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="p">]:</span>
        <span class="n">ticker</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">Ticker</span><span class="p">()</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">major</span> <span class="o">=</span> <span class="n">ticker</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">minor</span> <span class="o">=</span> <span class="n">ticker</span>
        <span class="c1"># No ticks and no labels</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">()</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">draw_colors</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">divider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;tab10&quot;</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw colormap onto the axis to separate the data</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axes object</span>
<span class="sd">        Axes in which to draw the colormap</span>
<span class="sd">    ax_type : char, optional</span>
<span class="sd">        Setting either the x or y axis, by default &quot;x&quot;</span>
<span class="sd">    meta : pd.DataFrame, pd.Series, list of pd.Series or np.array, optional</span>
<span class="sd">        Metadata of the matrix such as class, cell type, etc., by default None</span>
<span class="sd">    divider : AxesLocator, optional</span>
<span class="sd">        Divider used to add new axes to the plot</span>
<span class="sd">    color : str, list of str, or array_like, optional</span>
<span class="sd">        Attribute in meta by which to draw colorbars, by default None</span>
<span class="sd">    palette : str or dict, optional</span>
<span class="sd">        Colormap of the colorbar, by default &quot;tab10&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ax : matplotlib axes object</span>
<span class="sd">        Axes in which to draw the color map</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="n">color</span><span class="p">]</span>
    <span class="n">uni_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
    <span class="c1"># Create the color dictionary</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">color_dict</span> <span class="o">=</span> <span class="n">palette</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">color_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">uni_classes</span><span class="p">,</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">uni_classes</span><span class="p">)))</span>
        <span class="p">)</span>

    <span class="c1"># Make the colormap</span>
    <span class="n">class_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">uni_classes</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uni_classes</span><span class="p">))))</span>
    <span class="n">color_sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">color_dict</span><span class="o">.</span><span class="n">get</span><span class="p">)(</span><span class="n">uni_classes</span><span class="p">)</span>
    <span class="n">color_sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">color_sorted</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_sorted</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uni_classes</span><span class="p">):</span>
        <span class="n">color_sorted</span> <span class="o">=</span> <span class="n">color_sorted</span><span class="o">.</span><span class="n">T</span>
    <span class="n">lc</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">color_sorted</span><span class="p">)</span>
    <span class="n">class_indicator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">class_map</span><span class="o">.</span><span class="n">get</span><span class="p">)(</span><span class="n">classes</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
        <span class="n">class_indicator</span> <span class="o">=</span> <span class="n">class_indicator</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
        <span class="n">class_indicator</span> <span class="o">=</span> <span class="n">class_indicator</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
        <span class="n">class_indicator</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">lc</span><span class="p">,</span>
        <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">square</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>


<span class="k">def</span> <span class="nf">draw_separators</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">meta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;heatmap&quot;</span><span class="p">,</span>
    <span class="n">gridline_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw separators between groups on the plot</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axes object</span>
<span class="sd">        Axes in which to draw the ticks</span>
<span class="sd">    ax_type : char, optional</span>
<span class="sd">        Setting either the x or y axis, by default &quot;x&quot;</span>
<span class="sd">    meta : pd.DataFrame, pd.Series, list of pd.Series or np.array, optional</span>
<span class="sd">        Metadata of the matrix such as class, cell type, etc., by default None</span>
<span class="sd">    group : str, list of str, or array_like, optional</span>
<span class="sd">        Attribute in meta to group the graph in the plot, by default None</span>
<span class="sd">    plot_type : str, optional</span>
<span class="sd">        One of &quot;heatmap&quot; or &quot;scattermap&quot;, by default &quot;heatmap&quot;</span>
<span class="sd">    gridline_kws : dict, optional</span>
<span class="sd">        Plotting arguments for the separators, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ax : matplotlib axes object</span>
<span class="sd">        Axes in which to draw the ticks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">gridline_kws</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gridline_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">sep_inds</span> <span class="o">=</span> <span class="n">_get_separator_info</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;scattermap&quot;</span><span class="p">:</span>
            <span class="n">sep_inds</span> <span class="o">=</span> <span class="n">sep_inds</span> <span class="o">-</span> <span class="mf">0.5</span>

        <span class="k">if</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">lims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
            <span class="n">drawer</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span>
        <span class="k">elif</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">lims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">drawer</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span>

        <span class="c1"># Draw the separators</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sep_inds</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lims</span><span class="p">:</span>
                <span class="n">drawer</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">gridline_kws</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>


<span class="k">def</span> <span class="nf">draw_ticks</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">meta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group_border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;heatmap&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw ticks onto the axis of the plot to separate the data</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axes object</span>
<span class="sd">        Axes in which to draw the ticks</span>
<span class="sd">    ax_type : char, optional</span>
<span class="sd">        Setting either the x or y axis, by default &quot;x&quot;</span>
<span class="sd">    meta : pd.DataFrame, pd.Series, list of pd.Series or np.array, optional</span>
<span class="sd">        Metadata of the matrix such as class, cell type, etc., by default None</span>
<span class="sd">    group : str, list of str, or array_like, optional</span>
<span class="sd">        Attribute in meta to group the graph in the plot, by default None</span>
<span class="sd">    group_border : bool, optional</span>
<span class="sd">        Whether to draw separator on the tick axes, by default True</span>
<span class="sd">    plot_type : str, optional</span>
<span class="sd">        One of &quot;heatmap&quot; or &quot;scattermap&quot;, by default &quot;heatmap&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ax : matplotlib axes object</span>
<span class="sd">        Axes in which to draw the ticks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Identify the locations of the ticks</span>
    <span class="k">if</span> <span class="n">meta</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tick_inds</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">tick_labels</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Identify the center of each class</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">tick_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">center</span><span class="p">[</span><span class="s2">&quot;sort_idx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;heatmap&quot;</span><span class="p">:</span>
            <span class="n">tick_inds</span> <span class="o">=</span> <span class="n">tick_inds</span> <span class="o">+</span> <span class="mf">0.5</span>
        <span class="n">tick_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">tick_inds</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">tick_inds</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">group_border</span><span class="p">:</span>
        <span class="n">sep_inds</span> <span class="o">=</span> <span class="n">_get_separator_info</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;scattermap&quot;</span><span class="p">:</span>
            <span class="n">sep_inds</span> <span class="o">=</span> <span class="n">sep_inds</span> <span class="o">-</span> <span class="mf">0.5</span>

        <span class="k">if</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">drawer</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span>
        <span class="k">elif</span> <span class="n">ax_type</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">drawer</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sep_inds</span><span class="p">):</span>
            <span class="n">drawer</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>


<span class="k">def</span> <span class="nf">scattermap</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a matrix using points instead of a heatmap. Helpful for larger, sparse</span>
<span class="sd">    matrices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : np.narray, scipy.sparse.csr_matrix, ndim=2</span>
<span class="sd">        Matrix to plot</span>
<span class="sd">    ax: matplotlib axes object, optional</span>
<span class="sd">        Axes in which to draw the plot, by default None</span>
<span class="sd">    legend : bool, optional</span>
<span class="sd">        [description], by default False</span>
<span class="sd">    sizes : tuple, optional</span>
<span class="sd">        min and max of dot sizes, by default (5, 10)</span>
<span class="sd">    spines : bool, optional</span>
<span class="sd">        whether to keep the spines of the plot, by default False</span>
<span class="sd">    border : bool, optional</span>
<span class="sd">        [description], by default True</span>
<span class="sd">    **kws : dict, optional</span>
<span class="sd">        Additional plotting arguments</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ax: matplotlib axes object, optional</span>
<span class="sd">        Axes in which to draw the plot, by default None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
    <span class="n">n_verts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">inds</span><span class="p">]))</span>
    <span class="n">scatter_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">scatter_df</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edges</span>
    <span class="n">scatter_df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">scatter_df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">scatter_df</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
        <span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kws</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_verts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">n_verts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>


<span class="k">def</span> <span class="nf">sort_meta</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">group_order</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">],</span> <span class="n">item_order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sort the data and metadata according to the sorting method</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    length : int</span>
<span class="sd">        Number of nodes</span>
<span class="sd">    meta : pd.DataFrame, pd.Series, list of pd.Series or np.array, optional</span>
<span class="sd">        Metadata of the matrix such as class, cell type, etc., by default None</span>
<span class="sd">    group : str, list of str, or array_like, optional</span>
<span class="sd">        Attribute in meta to group the graph in the plot, by default None</span>
<span class="sd">    group_order : str, list of str, or array_like, optional</span>
<span class="sd">        Attribute of the sorting class to sort classes within the graph,</span>
<span class="sd">        by default &quot;size&quot;</span>
<span class="sd">    item_order : str, list of str, or array_like, optional</span>
<span class="sd">        Attribute in meta by which to sort elements within a class, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    inds :</span>
<span class="sd">        The index of the data after sorting</span>
<span class="sd">    meta :</span>
<span class="sd">        The metadata after sorting</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># if metadata does not exist, return the original data</span>
    <span class="k">if</span> <span class="n">meta</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">length</span><span class="p">),</span> <span class="n">meta</span>

    <span class="n">meta</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># total_sort_by keeps track of what attribute was used to sort</span>
    <span class="n">total_sort_by</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># create new columns in the dataframe that correspond to the sorting order</span>
    <span class="c1"># one problem with this current sorting algorithm is that we cannot sort</span>
    <span class="c1"># classes by size and other class attributes at the same time.</span>

    <span class="k">for</span> <span class="n">gc</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">co</span> <span class="ow">in</span> <span class="n">group_order</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">co</span> <span class="o">==</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span>
                <span class="n">class_size</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
                <span class="c1"># map each node from the sorting class</span>
                <span class="c1"># to their sorting class size</span>
                <span class="n">meta</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gc</span><span class="si">}</span><span class="s2">_size_order&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="n">gc</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">class_size</span><span class="p">)</span>
                <span class="n">total_sort_by</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gc</span><span class="si">}</span><span class="s2">_size_order&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">class_value</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">gc</span><span class="p">)[</span><span class="n">co</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="c1"># map each node from the sorting class</span>
                <span class="c1"># to certain sorting class attribute</span>
                <span class="n">meta</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gc</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">co</span><span class="si">}</span><span class="s2">_order&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="n">gc</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">class_value</span><span class="p">)</span>
                <span class="n">total_sort_by</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gc</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">co</span><span class="si">}</span><span class="s2">_order&quot;</span><span class="p">)</span>
        <span class="n">total_sort_by</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span>
    <span class="n">total_sort_by</span> <span class="o">+=</span> <span class="n">item_order</span>

    <span class="c1"># arbitrarily sort the data from 1 to length</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;sort_idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meta</span><span class="p">))</span>
    <span class="c1"># if we actually need to sort, sort by group_order, group, item_order</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">total_sort_by</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">meta</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">total_sort_by</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)</span>

    <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;sort_idx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;sort_idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meta</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">inds</span><span class="p">,</span> <span class="n">meta</span>


<div class="viewcode-block" id="matrixplot"><a class="viewcode-back" href="../../../reference/reference/plotting.html#graspologic.plot.matrixplot">[docs]</a><span class="k">def</span> <span class="nf">matrixplot</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">col_meta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">row_meta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;heatmap&quot;</span><span class="p">,</span>
    <span class="n">col_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">row_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">col_group_order</span><span class="o">=</span><span class="s2">&quot;size&quot;</span><span class="p">,</span>
    <span class="n">row_group_order</span><span class="o">=</span><span class="s2">&quot;size&quot;</span><span class="p">,</span>
    <span class="n">col_item_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">row_item_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">col_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">row_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">col_highlight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">row_highlight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">col_palette</span><span class="o">=</span><span class="s2">&quot;tab10&quot;</span><span class="p">,</span>
    <span class="n">row_palette</span><span class="o">=</span><span class="s2">&quot;tab10&quot;</span><span class="p">,</span>
    <span class="n">col_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">row_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">col_tick_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">row_tick_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">col_color_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">row_color_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">,</span>
    <span class="n">sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gridline_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">spinestyle_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">highlight_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kws</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sorts and plots a matrix in various ways, and with optional information added to the</span>
<span class="sd">    margin of the matrix plot.</span>

<span class="sd">    Read more in the `Tutorial https://microsoft.github.io/graspologic/tutorials/plotting/matrixplot.html`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : np.ndarray or scipy.sparse.csr_matrix with ndim=2</span>
<span class="sd">        Matrix to plot. Sparse matrix input is only accepted if ``plot_type == &#39;scattermap&#39;``.</span>
<span class="sd">    ax : matplotlib axes object (default=None)</span>
<span class="sd">        Axes in which to draw the plot. If no axis is passed, one will be created.</span>
<span class="sd">    plot_type : str in {&quot;heatmap&quot;, &quot;scattermap&quot;} (default=&quot;heatmap&quot;)</span>
<span class="sd">        &quot;heatmap&quot; will draw the matrix using :func:`seaborn.heatmap`, &quot;scattermap&quot; will</span>
<span class="sd">        draw each nonzero element of the matrix using :func:`seaborn.scatterplot`.</span>
<span class="sd">        &quot;scattermap&quot; is recommended for larger sparse matrices.</span>
<span class="sd">    {row,col}_meta : pd.DataFrame or None, (default=None)</span>
<span class="sd">        Metadata of the matrix.</span>

<span class="sd">        - ``{row,col}_meta`` is pd.DataFrame</span>
<span class="sd">            All sorting keywords should only be str or list of str.</span>
<span class="sd">            They should contain references to columns in ``meta``.</span>
<span class="sd">        - ``{row,col}_meta`` is None</span>
<span class="sd">            All sorting keywords should only array-like with the same length as the</span>
<span class="sd">            corresponding axis of ``data``.</span>
<span class="sd">    {row,col}_group : str, list of str, or array-like, (default=None)</span>
<span class="sd">        Attribute(s) by which to group rows/columns of ``data``. If multiple groups are</span>
<span class="sd">        specified, rows/columns will be sorted hierarchically (first by the first group),</span>
<span class="sd">        then within that group by a possible second group, etc.). Behaves similarly to</span>
<span class="sd">        :meth:`pandas.DataFrame.sort_values`.</span>
<span class="sd">    {row,col}_group_order : str, list of str, or array-like, (default=&quot;size&quot;)</span>
<span class="sd">        Attribute(s) by which to sort the groups if provided by ``{row,col}_group``.</span>
<span class="sd">        Groups are sorted by the mean of this attribute in ascending order. &quot;size&quot; is a</span>
<span class="sd">        special keyword which will sort groups by the number of elements per group.</span>
<span class="sd">    {row,col}_item_order : str, list of str, or array-like (default=None)</span>
<span class="sd">        Attribute(s) by which to sort the individual rows/columns within each group.</span>
<span class="sd">    {row,col}_color : str, list of str, or array-like (default=None)</span>
<span class="sd">        Attribute(s) to use for drawing colors on the borders of the matrix plot.</span>
<span class="sd">    {row,col}_highlight : str, list of str, or array-like (default=None)</span>
<span class="sd">        Attribute(s) in meta by which to draw highlighted separators between specific</span>
<span class="sd">        groups, can be useful for emphasizing a particular region of the plot. Styling</span>
<span class="sd">        of the highlighted separators can be specified via `spinestyle_kws`.</span>
<span class="sd">    {row,col}_palette : str, dict, list of str or dict (default=&quot;tab10&quot;)</span>
<span class="sd">        Colormap(s) of the color axes if specified by ``{row,col}_color``.</span>
<span class="sd">    {row,col}_ticks : bool, optional (default=True)</span>
<span class="sd">        Whether the plot has labels for the groups specified by ``{row,col}_group``.</span>
<span class="sd">    {row,col}_tick_pad : int or float (default=None)</span>
<span class="sd">        Custom padding to use for the distance between tick axes</span>
<span class="sd">    {row,col}_color_pad : int or float (default=None)</span>
<span class="sd">        Custom padding to use for the distance between color axes</span>
<span class="sd">    border : bool (default=True)</span>
<span class="sd">        Whether the plot should have a border.</span>
<span class="sd">    center : int (default=0)</span>
<span class="sd">        The value at which to center the colormap when plotting divergent data (only</span>
<span class="sd">        used when ``plot_type=&quot;heatmap&quot;``).</span>
<span class="sd">    cmap : str (default=&quot;RdBu_r&quot;)</span>
<span class="sd">        Colormap of the heatmap (only used when ``plot_type=&quot;heatmap&quot;``).</span>
<span class="sd">    sizes : tuple (default=(5, 10))</span>
<span class="sd">        Min and max sizes of dots (only used when ``plot_type=&quot;scattermap&quot;``).</span>
<span class="sd">    square : bool (default=False)</span>
<span class="sd">        Whether the plot should be square.</span>
<span class="sd">    gridline_kws : dict (default=None)</span>
<span class="sd">        Plotting arguments for the separators.</span>
<span class="sd">    spinestyle_kws : dict (default=None)</span>
<span class="sd">        Plotting arguments for the spine border.</span>
<span class="sd">    highlight_kws : dict (default=None)</span>
<span class="sd">        Plotting arguments for the highlighted separators.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Additional plotting arguments passed down to the plotting function which will</span>
<span class="sd">        draw the matrix ``data``, see ``plot_type`` for more information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ax : matplotlib axes object</span>
<span class="sd">        Axes in which to draw the plot, by default None</span>
<span class="sd">    divider : AxesLocator</span>
<span class="sd">        Divider used to add new axes to the plot</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># check for the plot type</span>
    <span class="n">plot_type_opts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scattermap&quot;</span><span class="p">,</span> <span class="s2">&quot;heatmap&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">plot_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_type_opts</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`plot_type` must be one of </span><span class="si">{</span><span class="n">plot_type_opts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># check for the type and dimension of the data</span>
    <span class="n">_check_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span>

    <span class="c1"># check for the types of the sorting arguments</span>
    <span class="p">(</span>
        <span class="n">col_meta</span><span class="p">,</span>
        <span class="n">col_group</span><span class="p">,</span>
        <span class="n">col_group_order</span><span class="p">,</span>
        <span class="n">col_item_order</span><span class="p">,</span>
        <span class="n">col_color</span><span class="p">,</span>
        <span class="n">col_highlight</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="n">_check_sorting_kws</span><span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">col_meta</span><span class="p">,</span>
        <span class="n">col_group</span><span class="p">,</span>
        <span class="n">col_group_order</span><span class="p">,</span>
        <span class="n">col_item_order</span><span class="p">,</span>
        <span class="n">col_color</span><span class="p">,</span>
        <span class="n">col_highlight</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="p">(</span>
        <span class="n">row_meta</span><span class="p">,</span>
        <span class="n">row_group</span><span class="p">,</span>
        <span class="n">row_group_order</span><span class="p">,</span>
        <span class="n">row_item_order</span><span class="p">,</span>
        <span class="n">row_color</span><span class="p">,</span>
        <span class="n">row_highlight</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="n">_check_sorting_kws</span><span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">row_meta</span><span class="p">,</span>
        <span class="n">row_group</span><span class="p">,</span>
        <span class="n">row_group_order</span><span class="p">,</span>
        <span class="n">row_item_order</span><span class="p">,</span>
        <span class="n">row_color</span><span class="p">,</span>
        <span class="n">row_highlight</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># check for the types of the plotting arguments</span>
    <span class="n">col_palette</span> <span class="o">=</span> <span class="n">_check_plotting_kws</span><span class="p">(</span><span class="n">col_palette</span><span class="p">,</span> <span class="n">col_color</span><span class="p">)</span>
    <span class="n">row_palette</span> <span class="o">=</span> <span class="n">_check_plotting_kws</span><span class="p">(</span><span class="n">row_palette</span><span class="p">,</span> <span class="n">row_color</span><span class="p">)</span>

    <span class="c1"># sort the data and the metadata according to the sorting method</span>
    <span class="n">col_inds</span><span class="p">,</span> <span class="n">col_meta</span> <span class="o">=</span> <span class="n">sort_meta</span><span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">col_meta</span><span class="p">,</span>
        <span class="n">col_group</span><span class="p">,</span>
        <span class="n">group_order</span><span class="o">=</span><span class="n">col_group_order</span><span class="p">,</span>
        <span class="n">item_order</span><span class="o">=</span><span class="n">col_item_order</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">row_inds</span><span class="p">,</span> <span class="n">row_meta</span> <span class="o">=</span> <span class="n">sort_meta</span><span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">row_meta</span><span class="p">,</span>
        <span class="n">row_group</span><span class="p">,</span>
        <span class="n">group_order</span><span class="o">=</span><span class="n">row_group_order</span><span class="p">,</span>
        <span class="n">item_order</span><span class="o">=</span><span class="n">row_item_order</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">row_inds</span><span class="p">,</span> <span class="n">col_inds</span><span class="p">)]</span>

    <span class="c1"># draw the main heatmap/scattermap</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;heatmap&quot;</span><span class="p">:</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kws</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;scattermap&quot;</span><span class="p">:</span>
        <span class="n">scattermap</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span>

    <span class="c1"># extra features of the graph</span>
    <span class="k">if</span> <span class="n">square</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;square&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;scattermap&quot;</span><span class="p">:</span>
        <span class="n">ax_pad</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax_pad</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">ax_pad</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">ax_pad</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span> <span class="o">-</span> <span class="n">ax_pad</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ax_pad</span><span class="p">)</span>

    <span class="c1"># make_axes_locatable allows us to create new axes like colormap</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># draw separators</span>
    <span class="c1"># draw top separators</span>
    <span class="n">draw_separators</span><span class="p">(</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">meta</span><span class="o">=</span><span class="n">col_meta</span><span class="p">,</span>
        <span class="n">group</span><span class="o">=</span><span class="n">col_group</span><span class="p">,</span>
        <span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span>
        <span class="n">gridline_kws</span><span class="o">=</span><span class="n">gridline_kws</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># draw left separators</span>
    <span class="n">draw_separators</span><span class="p">(</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">meta</span><span class="o">=</span><span class="n">row_meta</span><span class="p">,</span>
        <span class="n">group</span><span class="o">=</span><span class="n">row_group</span><span class="p">,</span>
        <span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span>
        <span class="n">gridline_kws</span><span class="o">=</span><span class="n">gridline_kws</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># draw highlighted separators</span>
    <span class="k">if</span> <span class="n">highlight_kws</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">highlight_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># draw top highlights</span>
    <span class="k">if</span> <span class="n">col_highlight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">draw_separators</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">meta</span><span class="o">=</span><span class="n">col_meta</span><span class="p">,</span>
            <span class="n">group</span><span class="o">=</span><span class="n">col_highlight</span><span class="p">,</span>
            <span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span>
            <span class="n">gridline_kws</span><span class="o">=</span><span class="n">highlight_kws</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="c1"># draw left highlights</span>
    <span class="k">if</span> <span class="n">row_highlight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">draw_separators</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
            <span class="n">meta</span><span class="o">=</span><span class="n">row_meta</span><span class="p">,</span>
            <span class="n">group</span><span class="o">=</span><span class="n">row_highlight</span><span class="p">,</span>
            <span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span>
            <span class="n">gridline_kws</span><span class="o">=</span><span class="n">highlight_kws</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># these two variables are used to identify the first axes</span>
    <span class="n">col_first_ax</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">row_first_ax</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># draw colors</span>
    <span class="c1"># draw top colors</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_color</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col_color_pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">col_color_pad</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_color</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">col_first_ax</span><span class="p">:</span>
            <span class="n">col_color_pad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">col_first_ax</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">rev_color</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">col_color</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_palette</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rev_color_palette</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">col_palette</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rev_color_palette</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">col_palette</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_color</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rev_color</span><span class="p">):</span>
            <span class="n">color_ax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span>
                <span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;3%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">col_color_pad</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax</span>
            <span class="p">)</span>
            <span class="n">_remove_shared_ax</span><span class="p">(</span><span class="n">color_ax</span><span class="p">)</span>
            <span class="n">draw_colors</span><span class="p">(</span>
                <span class="n">color_ax</span><span class="p">,</span>
                <span class="n">meta</span><span class="o">=</span><span class="n">col_meta</span><span class="p">,</span>
                <span class="n">divider</span><span class="o">=</span><span class="n">divider</span><span class="p">,</span>
                <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rev_color</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">rev_color_palette</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">)</span>
    <span class="c1"># draw left colors</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_color</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">row_color_pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">row_color_pad</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_color</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">row_first_ax</span><span class="p">:</span>
            <span class="n">row_color_pad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">row_first_ax</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">rev_color</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row_color</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_palette</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rev_color_palette</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row_palette</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rev_color_palette</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row_palette</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_color</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rev_color</span><span class="p">):</span>
            <span class="n">color_ax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span>
                <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;3%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">row_color_pad</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span>
            <span class="p">)</span>
            <span class="n">_remove_shared_ax</span><span class="p">(</span><span class="n">color_ax</span><span class="p">)</span>
            <span class="n">draw_colors</span><span class="p">(</span>
                <span class="n">color_ax</span><span class="p">,</span>
                <span class="n">meta</span><span class="o">=</span><span class="n">row_meta</span><span class="p">,</span>
                <span class="n">divider</span><span class="o">=</span><span class="n">divider</span><span class="p">,</span>
                <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rev_color</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">rev_color_palette</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">)</span>

    <span class="c1"># draw ticks</span>
    <span class="c1"># draw top ticks</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_group</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">col_ticks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col_tick_pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">col_tick_pad</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_group</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">col_first_ax</span><span class="p">:</span>
            <span class="n">col_tick_pad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">col_first_ax</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">col_tick_pad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="c1"># Reverse the order of the group class, so the ticks are drawn</span>
        <span class="c1"># in the opposite order</span>
        <span class="n">rev_group</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">col_group</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rev_group</span><span class="p">):</span>

            <span class="c1"># Add a new axis when needed</span>
            <span class="n">tick_ax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span>
                <span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;1%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">col_tick_pad</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax</span>
            <span class="p">)</span>
            <span class="n">_remove_shared_ax</span><span class="p">(</span><span class="n">tick_ax</span><span class="p">)</span>
            <span class="n">tick_ax</span> <span class="o">=</span> <span class="n">_set_spines</span><span class="p">(</span>
                <span class="n">tick_ax</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="c1"># Draw the ticks for the x axis</span>
            <span class="n">draw_ticks</span><span class="p">(</span>
                <span class="n">tick_ax</span><span class="p">,</span>
                <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
                <span class="n">meta</span><span class="o">=</span><span class="n">col_meta</span><span class="p">,</span>
                <span class="n">group</span><span class="o">=</span><span class="n">rev_group</span><span class="p">[</span><span class="n">i</span><span class="p">:],</span>
                <span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
    <span class="c1"># draw left ticks</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_group</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">row_ticks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">row_tick_pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">row_tick_pad</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_group</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">row_first_ax</span><span class="p">:</span>
            <span class="n">row_tick_pad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">row_first_ax</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">row_tick_pad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="c1"># Reverse the order of the group class, so the ticks are drawn</span>
        <span class="c1"># in the opposite order</span>
        <span class="n">rev_group</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row_group</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rev_group</span><span class="p">):</span>
            <span class="c1"># Add a new axis when needed</span>
            <span class="n">tick_ax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span>
                <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;1%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">row_tick_pad</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span>
            <span class="p">)</span>
            <span class="n">_remove_shared_ax</span><span class="p">(</span><span class="n">tick_ax</span><span class="p">)</span>
            <span class="n">tick_ax</span> <span class="o">=</span> <span class="n">_set_spines</span><span class="p">(</span>
                <span class="n">tick_ax</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="c1"># Draw the ticks for the y axis</span>
            <span class="n">draw_ticks</span><span class="p">(</span>
                <span class="n">tick_ax</span><span class="p">,</span>
                <span class="n">ax_type</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
                <span class="n">meta</span><span class="o">=</span><span class="n">row_meta</span><span class="p">,</span>
                <span class="n">group</span><span class="o">=</span><span class="n">rev_group</span><span class="p">[</span><span class="n">i</span><span class="p">:],</span>
                <span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="c1"># spines</span>
    <span class="k">if</span> <span class="n">spinestyle_kws</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">spinestyle_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">border</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">spinestyle_kws</span><span class="p">[</span><span class="s2">&quot;linewidth&quot;</span><span class="p">])</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_linestyle</span><span class="p">(</span><span class="n">spinestyle_kws</span><span class="p">[</span><span class="s2">&quot;linestyle&quot;</span><span class="p">])</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">spinestyle_kws</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">divider</span></div>


<div class="viewcode-block" id="adjplot"><a class="viewcode-back" href="../../../reference/reference/plotting.html#graspologic.plot.adjplot">[docs]</a><span class="k">def</span> <span class="nf">adjplot</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">meta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;heatmap&quot;</span><span class="p">,</span>
    <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group_order</span><span class="o">=</span><span class="s2">&quot;size&quot;</span><span class="p">,</span>
    <span class="n">item_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">highlight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;tab10&quot;</span><span class="p">,</span>
    <span class="n">ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">tick_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">color_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">,</span>
    <span class="n">sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gridline_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">spinestyle_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">highlight_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kws</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sorts and plots a square matrix in various ways, and with optional information added</span>
<span class="sd">    to the margin of the matrix plot.</span>

<span class="sd">    This function is a wrapper around ``matrixplot`` which assumes that the plotted</span>
<span class="sd">    matrix is square, and that the rows and columns represent the same items and have</span>
<span class="sd">    the same metadata (e.g. the adjacency matrix of a graph).</span>

<span class="sd">    Read more in the `Tutorial https://microsoft.github.io/graspologic/tutorials/plotting/matrixplot.html`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : np.ndarray or scipy.sparse.csr_matrix with ndim=2</span>
<span class="sd">        Matrix to plot, must be square.</span>
<span class="sd">        Sparse matrix input is only accepted if ``plot_type == &#39;scattermap&#39;``.</span>
<span class="sd">    ax : matplotlib axes object (default=None)</span>
<span class="sd">        Axes in which to draw the plot. If no axis is passed, one will be created.</span>
<span class="sd">    plot_type : str in {&quot;heatmap&quot;, &quot;scattermap&quot;} (default=&quot;heatmap&quot;)</span>
<span class="sd">        &quot;heatmap&quot; will draw the matrix using :func:`seaborn.heatmap`, &quot;scattermap&quot; will</span>
<span class="sd">        draw each nonzero element of the matrix using :func:`seaborn.scatterplot`.</span>
<span class="sd">        &quot;scattermap&quot; is recommended for larger sparse matrices.</span>
<span class="sd">    meta : pd.DataFrame or None, (default=None)</span>
<span class="sd">        Metadata of the matrix.</span>

<span class="sd">        - ``meta`` is pd.DataFrame</span>
<span class="sd">            All sorting keywords should only be str or list of str.</span>
<span class="sd">            They should contain references to columns in ``meta``.</span>
<span class="sd">        - ``meta`` is None</span>
<span class="sd">            All sorting keywords should only array-like with the same length as the</span>
<span class="sd">            corresponding axis of ``data``.</span>
<span class="sd">    group : str, list of str, or array-like, (default=None)</span>
<span class="sd">        Attribute(s) by which to group rows/columns of ``data``. If multiple groups are</span>
<span class="sd">        specified, rows/columns will be sorted hierarchically (first by the first group),</span>
<span class="sd">        then within that group by a possible second group, etc.). Behaves similarly to</span>
<span class="sd">        :meth:`pandas.DataFrame.sort_values`.</span>
<span class="sd">    group_order : str, list of str, or array-like, (default=&quot;size&quot;)</span>
<span class="sd">        Attribute(s) by which to sort the groups if provided by ``group``.</span>
<span class="sd">        Groups are sorted by the mean of this attribute in ascending order. &quot;size&quot; is a</span>
<span class="sd">        special keyword which will sort groups by the number of elements per group.</span>
<span class="sd">    item_order : str, list of str, or array-like (default=None)</span>
<span class="sd">        Attribute(s) by which to sort the individual rows/columns within each group.</span>
<span class="sd">    color : str, list of str, or array-like (default=None)</span>
<span class="sd">        Attribute(s) to use for drawing colors on the borders of the matrix plot.</span>
<span class="sd">    highlight : str, list of str, or array-like (default=None)</span>
<span class="sd">        Attribute(s) in meta by which to draw highlighted separators between specific</span>
<span class="sd">        groups, can be useful for emphasizing a particular region of the plot. Styling</span>
<span class="sd">        of the highlighted separators can be specified via `spinestyle_kws`.</span>
<span class="sd">    palette : str, dict, list of str or dict (default=&quot;tab10&quot;)</span>
<span class="sd">        Colormap(s) of the color axes if specified by ``color``.</span>
<span class="sd">    ticks : bool, optional (default=True)</span>
<span class="sd">        Whether the plot has labels for the groups specified by ``group``.</span>
<span class="sd">    tick_pad : int or float (default=None)</span>
<span class="sd">        Custom padding to use for the distance between tick axes</span>
<span class="sd">    color_pad : int or float (default=None)</span>
<span class="sd">        Custom padding to use for the distance between color axes</span>
<span class="sd">    border : bool (default=True)</span>
<span class="sd">        Whether the plot should have a border.</span>
<span class="sd">    center : int (default=0)</span>
<span class="sd">        The value at which to center the colormap when plotting divergent data (only</span>
<span class="sd">        used when ``plot_type=&quot;heatmap&quot;``).</span>
<span class="sd">    cmap : str (default=&quot;RdBu_r&quot;)</span>
<span class="sd">        Colormap of the heatmap (only used when ``plot_type=&quot;heatmap&quot;``).</span>
<span class="sd">    sizes : tuple (default=(5, 10))</span>
<span class="sd">        Min and max sizes of dots (only used when ``plot_type=&quot;scattermap&quot;``).</span>
<span class="sd">    square : bool (default=False)</span>
<span class="sd">        Whether the plot should be square.</span>
<span class="sd">    gridline_kws : dict (default=None)</span>
<span class="sd">        Plotting arguments for the separators.</span>
<span class="sd">    spinestyle_kws : dict (default=None)</span>
<span class="sd">        Plotting arguments for the spine border.</span>
<span class="sd">    highlight_kws : dict (default=None)</span>
<span class="sd">        Plotting arguments for the highlighted separators.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Additional plotting arguments passed down to the plotting function which will</span>
<span class="sd">        draw the matrix ``data``, see ``plot_type`` for more information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ax : matplotlib axes object</span>
<span class="sd">        Axes in which to draw the plot, by default None</span>
<span class="sd">    divider : AxesLocator</span>
<span class="sd">        Divider used to add new axes to the plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="n">matrixplot</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">col_meta</span><span class="o">=</span><span class="n">meta</span><span class="p">,</span>
        <span class="n">row_meta</span><span class="o">=</span><span class="n">meta</span><span class="p">,</span>
        <span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span>
        <span class="n">col_group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
        <span class="n">row_group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
        <span class="n">col_group_order</span><span class="o">=</span><span class="n">group_order</span><span class="p">,</span>
        <span class="n">row_group_order</span><span class="o">=</span><span class="n">group_order</span><span class="p">,</span>
        <span class="n">col_item_order</span><span class="o">=</span><span class="n">item_order</span><span class="p">,</span>
        <span class="n">row_item_order</span><span class="o">=</span><span class="n">item_order</span><span class="p">,</span>
        <span class="n">col_color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">row_color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">col_highlight</span><span class="o">=</span><span class="n">highlight</span><span class="p">,</span>
        <span class="n">row_highlight</span><span class="o">=</span><span class="n">highlight</span><span class="p">,</span>
        <span class="n">col_palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
        <span class="n">row_palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
        <span class="n">col_ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span>
        <span class="n">row_ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span>
        <span class="n">col_tick_pad</span><span class="o">=</span><span class="n">tick_pad</span><span class="p">,</span>
        <span class="n">row_tick_pad</span><span class="o">=</span><span class="n">tick_pad</span><span class="p">,</span>
        <span class="n">col_color_pad</span><span class="o">=</span><span class="n">color_pad</span><span class="p">,</span>
        <span class="n">row_color_pad</span><span class="o">=</span><span class="n">color_pad</span><span class="p">,</span>
        <span class="n">border</span><span class="o">=</span><span class="n">border</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span>
        <span class="n">square</span><span class="o">=</span><span class="n">square</span><span class="p">,</span>
        <span class="n">gridline_kws</span><span class="o">=</span><span class="n">gridline_kws</span><span class="p">,</span>
        <span class="n">spinestyle_kws</span><span class="o">=</span><span class="n">spinestyle_kws</span><span class="p">,</span>
        <span class="n">highlight_kws</span><span class="o">=</span><span class="n">highlight_kws</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kws</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">outs</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>